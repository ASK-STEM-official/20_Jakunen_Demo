# 要件定義書
## システム概要
### プロジェクト名
- プロジェクト名　さぬきオリーブ受注管理システム SO-OMS(ソームス)

### 目的
- これまで手動で行ってきた業務をシステム化し、受注・在庫・分析を一元管理することで手作業の負担を減らし、業務拡大に対応できる基盤を構築することが目的

### 背景
- 現在、ECサイトから出力された注文データをExcelで手動管理しており、在庫数とのずれやステータス更新漏れが発生している。
- 手作業の負担を減らし、在庫・受注管理を正確かつ効率的に行うため、本システムの導入を決定した。

### 想定利用者
- オリーブショップ運営者
- オリーブショップ従業員

## 業務要件
### 業務フロー
1. ECサイトに顧客が注文情報を入力し確定
2. ECサイトから受注情報のあるCSVデータを取得
3. ステータスを受注確定に変更(在庫引当、梱包)
4. ステータスを発送済みに変更(発送)
- 発送処理前にキャンセルが発生した場合、在庫を戻すなどの調整を行う
- 発送処理後のキャンセルについては、顧客との個別調整により返品処理を手動で対応する

### 開発範囲
- 今回は管理者向けのECサイトデータ取得、受注から配送までの業務フローを管理できるソフトウェアの開発を行う。
- 将来的に、配送用の送り状作成、配送中の情報の取得を管理するソフトウェアの開発が展望としてある

## 機能要件
### 管理者ログイン機能
- 事前登録された管理者IDとパスワードで認証機能を実装
- パスワードはPBKDF2(.Net標準)を利用するものとする。
- パスワード入力欄は*で伏せておく

### 受注管理機能
- 受注予約データの一覧表示
- 顧客、商品、ステータス、カテゴリごとの絞り込みが可能
- 受注予約データの詳細表示
- 詳細画面では、受注ステータス、配送先住所、支払い方法、受注明細などが表示・編集可能
- 受注情報の新規登録が可能
- 受注確定のデータのみを一括で発送済みにバルク処理可能。変更の際は確認ダイアログを表示

### 商品管理機能
- 登録商品の一覧表示、詳細表示が可能
- 商品の新規登録が可能
- 商品画像を将来的に追加することを想定し、商品一覧の各要素の幅は広くとる
- 商品名、商品説明、在庫数、単価などの表示・編集が可能

### 顧客管理機能
- 顧客データの一覧、詳細表示が可能
- 新規顧客の登録が可能
- 顧客名、住所、電話番号などの表示・編集が可能
- 顧客ごとの過去の注文履歴が閲覧可能

### 受注処理機能
- 受注一覧、受注詳細から受注ステータスの確認が可能
- 在庫数をチェックし、在庫引当が可能
- 受注詳細画面から、受注ステータスを「新規予約」「受注確定」「発送済み」「キャンセル」のように変更可能
- 受注確定時、該当商品の在庫数を減算する
- 受注確定の際、在庫数をチェックし在庫不足の場合はステータスを変更できないようにする
- 受注確定後のキャンセルは在庫数を増算し、ステータスをキャンセルに変更
- 発送済み後のキャンセルはステータス変更のみ
- キャンセル時の返金、返品等の処理は考慮しないものとする

### 在庫アラート機能
- 商品ごとのしきい値を在庫数が下回った場合、アラートを出す
- 在庫アラートは一覧で確認可能
- 在庫アラートの対応状況を確認・編集可能
- 在庫アラート発生時に、発注リストを作成し品切れを防止

### CSVインポート機能
- ECサイトのAPIから受注データをCSV形式で取得し、読み込み、データベースへ保存する
- 10分ごとに自動で取得しインポートする
- 手動で「取得ボタン」を利用し取得することも可能

### 簡易集計機能
- 指定期間内の売り上げ合計を出力する
- 商品別販売数の集計結果を表示する
- これらのデータは数値としてCSVに書き出しできるほか、アプリケーション内でグラフとして分析データを閲覧できるようにする。

## 非機能要件
### 受注予約明細情報の取り扱い
- 履歴保持の観点から商品が削除されても取引明細は削除しない
- 予約が削除された場合には明細も削除する
- ステータスの変更があった場合該当の明細情報IDと変更者、変更日時、変更前と変更後のデータを保持する

### ECサイトから取得するデータの取り扱い
- 個人情報保護の観点から、顧客の名前、住所など個人情報は分離したテーブルで管理する

### ソフトウェア設計
- クリーンアーキテクチャ+DDDを採用し、保守性・拡張性を高め、将来的な機能追加などのコスト削減を図る
- 将来的に、送り状自動発行システム・発注管理システムとの連携や統合を意識した設計とする

### データベース設計
- 在庫アラートを履歴としてテーブルに保存する事で、将来的に品切予測や売上分析に活用できるようにする
- 顧客データや商品データは物理削除とせず、論理削除とすることで履歴の追跡や会計監査に対応できるものとする
- また、顧客データの削除要求があった際は論理削除することで個人情報保護法に遵守する設計とする

## 使用技術
- 言語: C#
- フレームワーク: .NetFramework
### 開発環境
-  SQL Server 2022 Developer Edition CU19
- SQL Server Management Studio (SSMS) v20.2 
- Visual Studio Code (1.92.2) 